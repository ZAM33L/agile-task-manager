<header class="app-header">
  <h1>My Kanban</h1>
</header>

<div class="board-layout" cdkDropListGroup>

  @for (column of columns; track column.id) {
    <app-column
      [columnId]="column.id"
      [connectedTo]="connectedColumnIds"
      [title]="column.title"
      [tasks]="column.tasks"
      [color]="column.color"
      [showAddButton]="true"
      [showDeleteAll]="true"
      (addTask)="openAddModal(column.id)"
      (deleteAll)="openDeleteConfirm(column.id)"
      (edit)="openEditModal($event)"
      (delete)="openTaskDeleteConfirm($event)">
    </app-column>
  }

</div>


<!-- ADD MODAL -->
@if (showAddModal) {
<div class="modal-backdrop">
  <div class="modal">
    <h3>New Task</h3>

    <input type="text" placeholder="Title" [(ngModel)]="newTask.title">
    <textarea placeholder="Description" [(ngModel)]="newTask.description"></textarea>

    <select [(ngModel)]="newTask.priority">
      <option>High</option>
      <option>Medium</option>
      <option>Low</option>
    </select>

    <div class="modal-actions">
      <button (click)="addTask()">Add</button>
      <button (click)="closeAddModal()">Cancel</button>
    </div>
  </div>
</div>
}


<!-- EDIT MODAL -->
@if (showEditModal && editingTask) {
<div class="modal-backdrop">
  <div class="modal">
    <h3>Edit Task</h3>

    <input type="text" [(ngModel)]="editingTask.title">
    <textarea [(ngModel)]="editingTask.description"></textarea>

    <select [(ngModel)]="editingTask.priority">
      <option>High</option>
      <option>Medium</option>
      <option>Low</option>
    </select>

    <div class="modal-actions">
      <button (click)="updateTask()">Update</button>
      <button (click)="closeEditModal()">Cancel</button>
    </div>
  </div>
</div>
}


<!-- DELETE CONFIRM -->
@if (showDeleteConfirm) {
<div class="modal-overlay">
  <div class="modal-box">
    <h3>Confirm Deletion</h3>
    <p>Are you sure you want to delete all tasks?</p>

    <div class="modal-actions">
      <button class="cancel-btn" (click)="closeDeleteConfirm()">
        Cancel
      </button>

      <button class="danger-btn" (click)="confirmDelete()">
        Yes, Delete
      </button>
    </div>
  </div>
</div>
}

<!-- DELETE SINGLE TASK CONFIRM -->
@if (showTaskDeleteConfirm) {
<div class="modal-overlay">
  <div class="modal-box">
    <h3>Delete Task</h3>
    <p>Are you sure you want to delete this task?</p>

    <div class="modal-actions">
      <button class="cancel-btn" (click)="closeTaskDeleteConfirm()">
        Cancel
      </button>

      <button class="danger-btn" (click)="confirmTaskDelete()">
        Yes, Delete
      </button>
    </div>
  </div>
</div>
}

